<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content="í”„ë¦°ìŠ¤ ì—°ì°¨íœ´ê°€ ê´€ë¦¬ ì‹œìŠ¤í…œ">
<meta name="theme-color" content="#4F46E5">
<link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>ğŸ¢</text></svg>">
<title>í”„ë¦°ìŠ¤ ì—°ì°¨íœ´ê°€ ê´€ë¦¬ëŒ€ì¥</title>
<style>
  @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;500;600;700;800;900&display=swap');

  :root {
    --primary:#4F46E5;--primary-light:#818CF8;--primary-dark:#3730A3;
    --accent:#F59E0B;--accent-light:#FCD34D;
    --success:#10B981;--danger:#EF4444;--warning:#F97316;
    --bg:#F1F5F9;--card:#FFFFFF;--text:#1E293B;--text-light:#64748B;--border:#E2E8F0;
    --shadow:0 4px 24px rgba(0,0,0,0.08);--shadow-lg:0 12px 40px rgba(0,0,0,0.12);
    --radius:16px;--radius-sm:10px;
    --transition:all .3s cubic-bezier(.4,0,.2,1);
  }
  *{margin:0;padding:0;box-sizing:border-box;}
  body{font-family:'Noto Sans KR',sans-serif;background:var(--bg);color:var(--text);min-height:100vh;line-height:1.6;}

  /* HEADER */
  .header{background:linear-gradient(135deg,var(--primary),var(--primary-dark));padding:22px 32px;color:#fff;position:sticky;top:0;z-index:100;box-shadow:0 4px 20px rgba(79,70,229,.3);}
  .header-inner{max-width:1440px;margin:0 auto;display:flex;justify-content:space-between;align-items:center;flex-wrap:wrap;gap:10px;}
  .header h1{font-size:20px;font-weight:800;letter-spacing:-.5px;}
  .header h1 span{font-weight:400;font-size:12px;opacity:.8;margin-left:8px;}
  .header-right{display:flex;align-items:center;gap:8px;flex-wrap:wrap;}
  .today-badge{background:rgba(255,255,255,.18);padding:6px 13px;border-radius:20px;font-size:11px;backdrop-filter:blur(10px);}
  .admin-badge{background:rgba(255,255,255,.15);border:1px solid rgba(255,255,255,.3);padding:6px 13px;border-radius:20px;font-size:11px;cursor:pointer;transition:var(--transition);display:flex;align-items:center;gap:5px;}
  .admin-badge:hover{background:rgba(255,255,255,.3);}
  .admin-badge.active{background:var(--accent);color:#1E293B;font-weight:700;border-color:var(--accent);}
  .hbtn{border:none;padding:9px 20px;border-radius:10px;font-size:13px;font-weight:700;cursor:pointer;transition:var(--transition);display:flex;align-items:center;gap:6px;}
  .hbtn:hover{transform:translateY(-2px);}
  .hbtn-accent{background:var(--accent);color:#1E293B;box-shadow:0 4px 12px rgba(245,158,11,.4);}
  .hbtn-accent:hover{box-shadow:0 6px 20px rgba(245,158,11,.5);background:var(--accent-light);}

  /* TABS */
  .nav-tabs{max-width:1440px;margin:18px auto 0;padding:0 32px;display:flex;gap:5px;overflow-x:auto;}
  .nav-tab{padding:10px 20px;border-radius:10px 10px 0 0;border:none;background:var(--border);color:var(--text-light);font-size:12px;font-weight:600;cursor:pointer;transition:var(--transition);white-space:nowrap;}
  .nav-tab.active{background:var(--card);color:var(--primary);box-shadow:0 -2px 8px rgba(0,0,0,.04);}
  .nav-tab:hover:not(.active){background:#dde3ea;}
  .nav-tab.admin-only{display:none;}
  .nav-tab.admin-only.show{display:block;}

  .container{max-width:1440px;margin:0 auto;padding:0 32px 32px;}
  .tab-content{display:none;background:var(--card);border-radius:0 var(--radius) var(--radius) var(--radius);padding:26px;box-shadow:var(--shadow);animation:fadeIn .3s ease;}
  .tab-content.active{display:block;}
  @keyframes fadeIn{from{opacity:0;transform:translateY(6px)}to{opacity:1;transform:translateY(0)}}

  /* STATS */
  .stats-grid{display:grid;grid-template-columns:repeat(4,1fr);gap:14px;margin-bottom:24px;}
  .stat-card{background:linear-gradient(135deg,#F8FAFC,#F1F5F9);border-radius:var(--radius-sm);padding:18px;border:1px solid var(--border);transition:var(--transition);}
  .stat-card:hover{transform:translateY(-2px);box-shadow:var(--shadow);}
  .stat-card .label{font-size:10px;color:var(--text-light);font-weight:700;text-transform:uppercase;letter-spacing:.5px;}
  .stat-card .value{font-size:26px;font-weight:800;margin-top:2px;color:var(--primary);}
  .stat-card .sub{font-size:10px;color:var(--text-light);margin-top:1px;}

  .section-title{font-size:15px;font-weight:700;margin-bottom:14px;display:flex;align-items:center;gap:8px;}
  .section-title .icon{width:28px;height:28px;border-radius:7px;background:var(--primary);color:#fff;display:flex;align-items:center;justify-content:center;font-size:13px;}

  /* TABLE */
  .table-wrap{overflow-x:auto;}
  .emp-table{width:100%;border-collapse:separate;border-spacing:0;border-radius:var(--radius-sm);overflow:hidden;border:1px solid var(--border);min-width:700px;}
  .emp-table thead th{background:#F8FAFC;padding:11px 12px;font-size:10px;font-weight:700;color:var(--text-light);text-transform:uppercase;letter-spacing:.5px;border-bottom:2px solid var(--border);text-align:left;white-space:nowrap;}
  .emp-table tbody tr{transition:var(--transition);cursor:pointer;}
  .emp-table tbody tr:hover{background:#F8FAFC;}
  .emp-table tbody td{padding:12px;font-size:12px;border-bottom:1px solid var(--border);vertical-align:middle;}
  .emp-name{font-weight:700;color:var(--primary);display:flex;align-items:center;gap:8px;white-space:nowrap;}
  .emp-avatar{width:32px;height:32px;border-radius:8px;display:flex;align-items:center;justify-content:center;color:#fff;font-weight:800;font-size:12px;flex-shrink:0;}
  .gauge-wrap{display:flex;align-items:center;gap:7px;}
  .gauge-bar{flex:1;height:7px;background:#E2E8F0;border-radius:4px;overflow:hidden;min-width:70px;}
  .gauge-fill{height:100%;border-radius:4px;transition:width 1s ease;}
  .gauge-text{font-size:10px;font-weight:700;color:var(--text-light);white-space:nowrap;}
  .badge{padding:3px 8px;border-radius:5px;font-size:9px;font-weight:700;}
  .badge-green{background:#ECFDF5;color:#059669;}
  .badge-yellow{background:#FFFBEB;color:#D97706;}
  .badge-red{background:#FEF2F2;color:#DC2626;}

  /* CALENDAR */
  .cal-header{display:flex;justify-content:space-between;align-items:center;margin-bottom:18px;flex-wrap:wrap;gap:10px;}
  .cal-nav{display:flex;align-items:center;gap:12px;}
  .cal-nav button{width:34px;height:34px;border-radius:8px;border:1px solid var(--border);background:#fff;cursor:pointer;font-size:15px;transition:var(--transition);display:flex;align-items:center;justify-content:center;}
  .cal-nav button:hover{background:var(--primary);color:#fff;border-color:var(--primary);}
  .cal-month-title{font-size:18px;font-weight:800;}
  .cal-legend{display:flex;gap:12px;flex-wrap:wrap;}
  .cal-legend-item{display:flex;align-items:center;gap:4px;font-size:10px;font-weight:600;color:var(--text-light);}
  .cal-legend-dot{width:10px;height:10px;border-radius:3px;}
  .calendar-grid{display:grid;grid-template-columns:repeat(7,1fr);gap:1px;border-radius:var(--radius-sm);overflow:hidden;background:var(--border);}
  .cal-day-header{padding:8px;text-align:center;font-size:10px;font-weight:700;color:var(--text-light);background:#F8FAFC;}
  .cal-day-header:first-child{color:var(--danger);}
  .cal-day-header:last-child{color:var(--primary);}
  .cal-day{min-height:85px;background:#fff;padding:5px;transition:var(--transition);position:relative;}
  .cal-day:hover{background:#F8FAFC;z-index:2;box-shadow:0 2px 8px rgba(0,0,0,.08);}
  .cal-day.other-month{background:#FAFAFA;opacity:.35;}
  .cal-day.today{box-shadow:inset 0 0 0 2px var(--primary);background:#EEF2FF;}
  .cal-day.sunday .cal-date{color:var(--danger);}
  .cal-day.saturday .cal-date{color:var(--primary);}
  .cal-day.holiday{background:#FFF5F5;}
  .cal-date{font-size:11px;font-weight:700;margin-bottom:2px;}
  .cal-event{font-size:9px;padding:1px 4px;border-radius:3px;margin-bottom:1px;font-weight:600;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;cursor:default;line-height:1.4;}
  .cal-event.annual{background:#DBEAFE;color:#1D4ED8;}
  .cal-event.half{background:#FEF3C7;color:#B45309;}
  .cal-event.quarter{background:#E0E7FF;color:#4338CA;}
  .cal-event.holiday-ev{background:#FEE2E2;color:#DC2626;font-weight:700;}

  /* MODAL */
  .modal-overlay{display:none;position:fixed;top:0;left:0;right:0;bottom:0;background:rgba(0,0,0,.5);z-index:1000;backdrop-filter:blur(4px);justify-content:center;align-items:center;}
  .modal-overlay.show{display:flex;animation:fadeIn .25s ease;}
  .modal{background:#fff;border-radius:var(--radius);width:540px;max-width:95vw;max-height:92vh;overflow-y:auto;box-shadow:var(--shadow-lg);animation:slideUp .3s ease;}
  @keyframes slideUp{from{transform:translateY(30px);opacity:0}to{transform:translateY(0);opacity:1}}
  .modal-header{padding:20px 24px 0;display:flex;justify-content:space-between;align-items:center;}
  .modal-header h2{font-size:17px;font-weight:800;}
  .modal-close{width:32px;height:32px;border-radius:8px;border:none;background:#F1F5F9;cursor:pointer;font-size:15px;transition:var(--transition);display:flex;align-items:center;justify-content:center;}
  .modal-close:hover{background:var(--danger);color:#fff;}
  .modal-body{padding:20px 24px 24px;}

  /* FORM */
  .form-group{margin-bottom:16px;}
  .form-label{font-size:11px;font-weight:700;color:var(--text-light);margin-bottom:6px;display:block;}
  .form-step-num{display:inline-flex;width:18px;height:18px;border-radius:5px;background:var(--primary);color:#fff;font-size:9px;font-weight:800;align-items:center;justify-content:center;margin-right:4px;}
  .form-input{width:100%;padding:9px 12px;border-radius:8px;border:2px solid var(--border);font-size:13px;font-family:inherit;transition:var(--transition);outline:none;}
  .form-input:focus{border-color:var(--primary);box-shadow:0 0 0 3px rgba(79,70,229,.1);}
  .form-row{display:grid;grid-template-columns:1fr 1fr;gap:10px;}
  .form-select{width:100%;padding:9px 12px;border-radius:8px;border:2px solid var(--border);font-size:13px;font-family:inherit;transition:var(--transition);outline:none;background:#fff;cursor:pointer;}
  .form-select:focus{border-color:var(--primary);}
  .option-group{display:flex;gap:6px;flex-wrap:wrap;}
  .option-btn{padding:8px 16px;border-radius:8px;border:2px solid var(--border);background:#fff;cursor:pointer;font-size:12px;font-weight:600;transition:var(--transition);text-align:center;flex:1;min-width:65px;}
  .option-btn:hover{border-color:var(--primary-light);background:#EEF2FF;}
  .option-btn.selected{border-color:var(--primary);background:var(--primary);color:#fff;box-shadow:0 4px 12px rgba(79,70,229,.3);}
  .sub-option-group{margin-top:8px;display:none;gap:5px;flex-wrap:wrap;}
  .sub-option-group.show{display:flex;}
  .sub-option-btn{padding:6px 11px;border-radius:6px;border:1.5px solid var(--border);background:#F8FAFC;cursor:pointer;font-size:11px;font-weight:600;transition:var(--transition);}
  .sub-option-btn:hover{border-color:var(--accent);}
  .sub-option-btn.selected{border-color:var(--accent);background:var(--accent);color:#fff;}

  /* DATE PICKER */
  .date-picker-area{border:2px solid var(--border);border-radius:var(--radius-sm);padding:12px;}
  .dp-header{display:flex;justify-content:space-between;align-items:center;margin-bottom:8px;}
  .dp-header button{background:none;border:1px solid var(--border);border-radius:5px;width:28px;height:28px;cursor:pointer;transition:var(--transition);display:flex;align-items:center;justify-content:center;}
  .dp-header button:hover{background:var(--primary);color:#fff;border-color:var(--primary);}
  .dp-title{font-size:13px;font-weight:700;}
  .dp-grid{display:grid;grid-template-columns:repeat(7,1fr);gap:2px;text-align:center;}
  .dp-day-header{font-size:9px;font-weight:700;color:var(--text-light);padding:4px 0;}
  .dp-day{padding:6px 2px;border-radius:6px;font-size:11px;cursor:pointer;transition:var(--transition);font-weight:500;}
  .dp-day:hover:not(.dp-disabled):not(.dp-empty){background:#EEF2FF;}
  .dp-day.dp-selected{background:var(--primary)!important;color:#fff!important;font-weight:700;}
  .dp-day.dp-today{border:2px solid var(--primary);font-weight:700;}
  .dp-day.dp-disabled{color:#CBD5E1;cursor:not-allowed;}
  .dp-day.dp-empty{cursor:default;}
  .dp-day.dp-sunday{color:var(--danger);}
  .dp-day.dp-saturday{color:var(--primary);}
  .dp-day.dp-holiday{color:var(--danger);font-weight:700;}
  .selected-dates{margin-top:8px;display:flex;flex-wrap:wrap;gap:4px;}
  .selected-date-tag{background:#EEF2FF;color:var(--primary);padding:4px 9px;border-radius:6px;font-size:10px;font-weight:600;display:flex;align-items:center;gap:4px;}
  .selected-date-tag .remove{cursor:pointer;font-size:12px;opacity:.6;transition:var(--transition);}
  .selected-date-tag .remove:hover{opacity:1;color:var(--danger);}

  .btn-submit{width:100%;padding:12px;border-radius:10px;border:none;background:linear-gradient(135deg,var(--primary),var(--primary-dark));color:#fff;font-size:14px;font-weight:700;cursor:pointer;transition:var(--transition);box-shadow:0 4px 12px rgba(79,70,229,.3);}
  .btn-submit:hover{transform:translateY(-2px);box-shadow:0 6px 20px rgba(79,70,229,.4);}
  .btn-submit:disabled{opacity:.5;cursor:not-allowed;transform:none;}
  .btn-submit.green{background:linear-gradient(135deg,var(--success),#059669);box-shadow:0 4px 12px rgba(16,185,129,.3);}
  .btn-submit.green:hover{box-shadow:0 6px 20px rgba(16,185,129,.4);}
  .btn-submit.orange{background:linear-gradient(135deg,var(--warning),#EA580C);}

  .remaining-notice{background:#F0FDF4;border:1px solid #BBF7D0;border-radius:7px;padding:8px 12px;font-size:11px;color:#16A34A;font-weight:600;margin-bottom:12px;display:flex;align-items:center;gap:5px;}
  .conflict-warning{background:#FEF2F2;border:1px solid #FECACA;border-radius:7px;padding:8px 12px;font-size:11px;color:var(--danger);font-weight:600;margin-top:7px;display:none;align-items:center;gap:5px;}
  .conflict-warning.show{display:flex;}
  .team-schedule-preview{margin-top:8px;background:#FFFBEB;border:1px solid #FDE68A;border-radius:7px;padding:9px;display:none;}
  .team-schedule-preview.show{display:block;}
  .team-schedule-preview h5{font-size:10px;font-weight:700;color:#92400E;margin-bottom:4px;}
  .team-schedule-preview .sch-item{font-size:10px;color:#B45309;padding:1px 0;}

  /* DETAIL */
  .detail-header{display:flex;align-items:center;gap:12px;margin-bottom:18px;}
  .detail-avatar{width:48px;height:48px;border-radius:12px;display:flex;align-items:center;justify-content:center;color:#fff;font-weight:800;font-size:18px;}
  .detail-info h3{font-size:17px;font-weight:800;}
  .detail-info p{font-size:11px;color:var(--text-light);}
  .detail-stats{display:grid;grid-template-columns:repeat(4,1fr);gap:8px;margin-bottom:18px;}
  .detail-stat{background:#F8FAFC;border-radius:var(--radius-sm);padding:12px;text-align:center;}
  .detail-stat .val{font-size:20px;font-weight:800;color:var(--primary);}
  .detail-stat .lbl{font-size:9px;color:var(--text-light);font-weight:600;margin-top:1px;}
  .detail-gauge{margin-bottom:18px;background:#F8FAFC;border-radius:var(--radius-sm);padding:16px;}
  .detail-gauge-title{font-size:11px;font-weight:700;color:var(--text-light);margin-bottom:7px;}
  .detail-gauge-bar{height:12px;background:#E2E8F0;border-radius:6px;overflow:hidden;}
  .detail-gauge-fill{height:100%;border-radius:6px;transition:width 1.2s ease;}
  .detail-gauge-labels{display:flex;justify-content:space-between;margin-top:5px;font-size:10px;color:var(--text-light);}
  .history-list{max-height:260px;overflow-y:auto;}
  .history-item{display:flex;align-items:center;gap:8px;padding:9px 0;border-bottom:1px solid #F1F5F9;}
  .history-dot{width:8px;height:8px;border-radius:50%;flex-shrink:0;}
  .history-dot.annual{background:#3B82F6;}.history-dot.half{background:#F59E0B;}.history-dot.quarter{background:#8B5CF6;}
  .history-date{font-size:11px;font-weight:600;min-width:85px;}
  .history-type{font-size:10px;padding:2px 7px;border-radius:4px;font-weight:600;}
  .history-type.annual{background:#DBEAFE;color:#1D4ED8;}.history-type.half{background:#FEF3C7;color:#B45309;}.history-type.quarter{background:#EDE9FE;color:#6D28D9;}
  .history-del{margin-left:auto;font-size:9px;padding:2px 7px;border-radius:4px;border:1px solid #FECACA;background:#FEF2F2;color:var(--danger);cursor:pointer;font-weight:600;display:none;transition:var(--transition);}
  .history-del.show{display:block;}
  .history-del:hover{background:var(--danger);color:#fff;}

  /* TOAST & SAVE */
  .copy-toast{position:fixed;bottom:36px;left:50%;transform:translateX(-50%) translateY(100px);background:#1E293B;color:#fff;padding:12px 24px;border-radius:10px;font-size:12px;font-weight:600;box-shadow:var(--shadow-lg);z-index:2000;transition:transform .4s cubic-bezier(.4,0,.2,1);display:flex;align-items:center;gap:7px;white-space:nowrap;}
  .copy-toast.show{transform:translateX(-50%) translateY(0);}
  .save-indicator{position:fixed;bottom:16px;right:16px;z-index:500;background:#1E293B;color:#fff;padding:8px 14px;border-radius:8px;font-size:11px;font-weight:600;box-shadow:var(--shadow-lg);transform:translateY(80px);transition:transform .3s ease;display:flex;align-items:center;gap:6px;}
  .save-indicator.show{transform:translateY(0);}

  /* POLICY */
  .policy-grid{display:grid;grid-template-columns:repeat(2,1fr);gap:14px;}
  .policy-card{background:#F8FAFC;border-radius:var(--radius-sm);padding:20px;border:1px solid var(--border);}
  .policy-card h4{font-size:13px;font-weight:700;margin-bottom:8px;display:flex;align-items:center;gap:6px;}
  .policy-card li{font-size:11px;color:var(--text-light);line-height:1.9;}
  .policy-card ul{padding-left:14px;}

  /* ADMIN */
  .admin-section{margin-bottom:24px;}
  .admin-section-title{font-size:14px;font-weight:700;margin-bottom:12px;padding-bottom:8px;border-bottom:2px solid var(--border);display:flex;align-items:center;gap:7px;}
  .admin-card{background:#F8FAFC;border-radius:var(--radius-sm);padding:18px;border:1px solid var(--border);margin-bottom:10px;}
  .admin-emp-row{display:flex;align-items:center;gap:12px;padding:10px 0;border-bottom:1px solid var(--border);flex-wrap:wrap;}
  .admin-emp-row:last-child{border-bottom:none;}
  .admin-emp-name{font-weight:700;font-size:13px;min-width:90px;display:flex;align-items:center;gap:7px;}
  .admin-emp-info{font-size:11px;color:var(--text-light);display:flex;gap:14px;flex-wrap:wrap;}
  .admin-emp-actions{margin-left:auto;display:flex;gap:5px;}
  .admin-btn{padding:5px 12px;border-radius:6px;border:none;font-size:10px;font-weight:700;cursor:pointer;transition:var(--transition);}
  .admin-btn:hover{transform:translateY(-1px);filter:brightness(1.1);}
  .admin-btn-primary{background:var(--primary);color:#fff;}
  .admin-btn-success{background:var(--success);color:#fff;}
  .admin-btn-warning{background:var(--warning);color:#fff;}
  .admin-btn-danger{background:var(--danger);color:#fff;}
  .data-actions{display:flex;gap:8px;flex-wrap:wrap;margin-top:12px;}
  .login-box{max-width:340px;margin:0 auto;text-align:center;}
  .login-box .lock-icon{font-size:44px;margin-bottom:12px;}
  .login-box p{font-size:12px;color:var(--text-light);margin-bottom:12px;}
  .pw-row{display:flex;gap:7px;}

  /* FOOTER */
  .footer{text-align:center;padding:20px;font-size:11px;color:var(--text-light);}
  .footer a{color:var(--primary);text-decoration:none;}

  @media(max-width:768px){
    .header{padding:16px 12px;}
    .header-inner{flex-direction:column;gap:8px;text-align:center;}
    .header-right{flex-direction:column;width:100%;}
    .container{padding:0 8px 20px;}
    .nav-tabs{padding:0 8px;margin-top:12px;}
    .tab-content{padding:16px 12px;}
    .stats-grid{grid-template-columns:repeat(2,1fr);gap:6px;}
    .stat-card .value{font-size:20px;}
    .policy-grid{grid-template-columns:1fr;}
    .detail-stats{grid-template-columns:repeat(2,1fr);}
    .modal{width:98vw;}
    .cal-day{min-height:55px;padding:2px;}
    .cal-event{font-size:7px;padding:1px 2px;}
    .form-row{grid-template-columns:1fr;}
    .admin-emp-row{flex-direction:column;align-items:flex-start;}
    .admin-emp-actions{margin-left:0;margin-top:6px;}
  }
  ::-webkit-scrollbar{width:5px;}
  ::-webkit-scrollbar-track{background:transparent;}
  ::-webkit-scrollbar-thumb{background:#CBD5E1;border-radius:3px;}
</style>
</head>
<body>

<div class="header">
  <div class="header-inner">
    <h1>ğŸ¢ í”„ë¦°ìŠ¤ ì—°ì°¨íœ´ê°€ ê´€ë¦¬<span>2025~2026</span></h1>
    <div class="header-right">
      <div class="today-badge" id="todayBadge"></div>
      <div class="admin-badge" id="adminBadge" onclick="toggleAdmin()">ğŸ”’ ê´€ë¦¬ì</div>
      <button class="hbtn hbtn-accent" onclick="openApplyModal()">âœï¸ ì—°ì°¨ ì‹ ì²­</button>
    </div>
  </div>
</div>

<div class="container">
  <div class="nav-tabs">
    <button class="nav-tab active" onclick="switchTab('dashboard',this)">ğŸ“Š ëŒ€ì‹œë³´ë“œ</button>
    <button class="nav-tab" onclick="switchTab('calendar',this)">ğŸ“… ìº˜ë¦°ë”</button>
    <button class="nav-tab" onclick="switchTab('policy',this)">ğŸ“‹ ì—°ì°¨ê·œì •</button>
    <button class="nav-tab admin-only" id="tabAdmin" onclick="switchTab('admin',this)">âš™ï¸ ê´€ë¦¬ì</button>
  </div>

  <!-- DASHBOARD -->
  <div class="tab-content active" id="tab-dashboard">
    <div class="stats-grid" id="statsGrid"></div>
    <div class="section-title"><div class="icon">ğŸ‘¤</div>ì§ì›ë³„ ì—°ì°¨ í˜„í™©</div>
    <div class="table-wrap">
      <table class="emp-table">
        <thead><tr><th>ì§ì›ëª…</th><th>ì‚¬ë²ˆ</th><th>ì´ì—°ì°¨</th><th>ì‚¬ìš©</th><th>ì”ì—¬</th><th>ì‚¬ìš©ë¥ </th><th>ê°±ì‹ ì¼</th><th>ìƒíƒœ</th></tr></thead>
        <tbody id="empTableBody"></tbody>
      </table>
    </div>
  </div>

  <!-- CALENDAR -->
  <div class="tab-content" id="tab-calendar">
    <div class="cal-header">
      <div class="cal-nav">
        <button onclick="changeCalMonth(-1)">â—€</button>
        <span class="cal-month-title" id="calMonthTitle"></span>
        <button onclick="changeCalMonth(1)">â–¶</button>
      </div>
      <div class="cal-legend">
        <div class="cal-legend-item"><div class="cal-legend-dot" style="background:#DBEAFE;border:1px solid #93C5FD"></div>ì—°ì°¨</div>
        <div class="cal-legend-item"><div class="cal-legend-dot" style="background:#FEF3C7;border:1px solid #FCD34D"></div>ë°˜ì°¨</div>
        <div class="cal-legend-item"><div class="cal-legend-dot" style="background:#E0E7FF;border:1px solid #A5B4FC"></div>ë°˜ë°˜ì°¨</div>
        <div class="cal-legend-item"><div class="cal-legend-dot" style="background:#FEE2E2;border:1px solid #FCA5A5"></div>ê³µíœ´ì¼</div>
      </div>
    </div>
    <div class="calendar-grid" id="calendarGrid"></div>
  </div>

  <!-- POLICY -->
  <div class="tab-content" id="tab-policy">
    <div class="section-title" style="margin-bottom:18px"><div class="icon">ğŸ“‹</div>ì—°ì°¨ìœ ê¸‰íœ´ê°€ ì§€ì¹¨ (2022.1.1 ê°œì •)</div>
    <div class="policy-grid">
      <div class="policy-card"><h4>ğŸ“Œ ì—°ì°¨ ë°œìƒ ê¸°ì¤€</h4><ul><li>1ë…„ê°„ 80% ì´ìƒ ì¶œê·¼ â†’ <b>15ì¼</b></li><li>1ë…„ê°„ 80% ë¯¸ë§Œ ì¶œê·¼ â†’ ì›” 1ì¼</li><li>3ë…„ ì´ìƒ ê·¼ì† ë§¤ <b>2ë…„ë§ˆë‹¤ 1ì¼</b> ì¶”ê°€</li><li>ìµœì´ˆ 15ì¼ì— <b>í•˜ê³„íœ´ê°€ 5ì¼ í¬í•¨</b></li></ul></div>
      <div class="policy-card"><h4>â° ë°˜ì°¨ ì‹œê°„</h4><ul><li><b>1ë¶€ (ì˜¤ì „):</b> 9:30 ~ 14:00</li><li><b>2ë¶€ (ì˜¤í›„):</b> 14:00 ~ 18:30</li></ul></div>
      <div class="policy-card"><h4>ğŸ• ë°˜ë°˜ì°¨ (ì‹œê°„ì°¨)</h4><ul><li>2025.12ì›”ë¶€í„° ì‹œí–‰</li><li>09:30~18:00 ì¤‘ <b>2ì‹œê°„ ë‹¨ìœ„</b></li><li>íŒ€ì› ê°„ ì—…ë¬´ê³µë°± ê³ ë ¤</li></ul></div>
      <div class="policy-card"><h4>âš ï¸ ì£¼ì˜ì‚¬í•­</h4><ul><li>ë§¤ì¶œ ì‹œì¦Œ ì‚¬ìš© ìì œ (ëŒ€í‘œ ìƒì˜)</li><li>ê°™ì€ íŒ€ì› <b>ë™ì¼ë‚  ì¤‘ë³µ ë¶ˆê°€</b></li><li>ë¯¸ì‚¬ìš© ì—°ì°¨ â†’ <b>ìˆ˜ë‹¹ ì§€ê¸‰</b></li></ul></div>
    </div>
  </div>

  <!-- ADMIN -->
  <div class="tab-content" id="tab-admin">
    <div id="adminLocked">
      <div class="login-box">
        <div class="lock-icon">ğŸ”</div>
        <h3 style="margin-bottom:6px">ê´€ë¦¬ì ì¸ì¦</h3>
        <p>ê´€ë¦¬ì ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•˜ì„¸ìš”.</p>
        <div class="pw-row">
          <input type="password" class="form-input" id="adminPwInput" placeholder="ë¹„ë°€ë²ˆí˜¸" onkeypress="if(event.key==='Enter')loginAdmin()">
          <button class="btn-submit" style="width:auto;padding:9px 22px" onclick="loginAdmin()">í™•ì¸</button>
        </div>
        <p id="adminPwError" style="color:var(--danger);margin-top:6px;display:none;font-size:12px">ë¹„ë°€ë²ˆí˜¸ê°€ í‹€ë ¸ìŠµë‹ˆë‹¤.</p>
      </div>
    </div>
    <div id="adminPanel" style="display:none">
      <div class="admin-section">
        <div class="admin-section-title">ğŸ‘¥ ì§ì› ê´€ë¦¬</div>
        <div id="adminEmpList"></div>
        <button class="btn-submit green" style="margin-top:12px" onclick="openAddEmpModal()">â• ì‹ ê·œ ì§ì› ì¶”ê°€</button>
      </div>
      <div class="admin-section">
        <div class="admin-section-title">ğŸ”„ ì—°ì°¨ ê°±ì‹  / ë¶€ì—¬</div>
        <div class="admin-card">
          <p style="font-size:12px;color:var(--text-light);margin-bottom:12px">ì§ì› ì„ íƒ í›„ ì—°ì°¨ë¥¼ ê°±ì‹ í•˜ê±°ë‚˜ ì¶”ê°€ ë¶€ì—¬í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
          <div class="form-row" style="margin-bottom:10px">
            <div><label class="form-label">ëŒ€ìƒ ì§ì›</label><select class="form-select" id="adminTargetEmp"></select></div>
            <div><label class="form-label">ì‘ì—… ì„ íƒ</label><select class="form-select" id="adminAction"><option value="renew">ì—°ì°¨ ê°±ì‹  (ìƒˆ ì—°ë„)</option><option value="grant">ì—°ì°¨ ì¶”ê°€ ë¶€ì—¬</option><option value="setTotal">ì´ ì—°ì°¨ì¼ìˆ˜ ë³€ê²½</option><option value="setRemain">ì”ì—¬ì¼ìˆ˜ ì§ì ‘ ìˆ˜ì •</option></select></div>
          </div>
          <div class="form-row" style="margin-bottom:12px">
            <div><label class="form-label">ì¼ìˆ˜ / ê°’</label><input type="number" class="form-input" id="adminDays" placeholder="ì˜ˆ: 15" step="0.25" min="0"></div>
            <div><label class="form-label">ê°±ì‹ ë…„ì›” (ì„ íƒ)</label><input type="month" class="form-input" id="adminRenewMonth"></div>
          </div>
          <button class="btn-submit orange" onclick="executeAdminAction()">âœ… ì‹¤í–‰</button>
        </div>
      </div>
      <div class="admin-section">
        <div class="admin-section-title">ğŸ—‘ï¸ ì‚¬ìš© ì´ë ¥ ê´€ë¦¬</div>
        <p style="font-size:12px;color:var(--text-light)">ì§ì› ìƒì„¸ ë³´ê¸°ì—ì„œ ê°œë³„ ì´ë ¥ì„ ì‚­ì œí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤ (ê´€ë¦¬ì ëª¨ë“œì—ì„œë§Œ).</p>
      </div>
      <div class="admin-section">
        <div class="admin-section-title">ğŸ’¾ ë°ì´í„° ê´€ë¦¬</div>
        <div class="admin-card">
          <p style="font-size:12px;color:var(--text-light);margin-bottom:8px">ëª¨ë“  ë°ì´í„°ëŠ” ë¸Œë¼ìš°ì € ë¡œì»¬ ì €ì¥ì†Œì— ìë™ ì €ì¥ë©ë‹ˆë‹¤.<br>âš ï¸ GitHub PagesëŠ” ì •ì  í˜¸ìŠ¤íŒ…ì´ë¯€ë¡œ <b>ê° ë¸Œë¼ìš°ì €ë³„ ê°œë³„ ì €ì¥</b>ì…ë‹ˆë‹¤.<br>íŒ€ ê³µìœ ë¥¼ ìœ„í•´ JSON ë‚´ë³´ë‚´ê¸°/ê°€ì ¸ì˜¤ê¸°ë¥¼ í™œìš©í•˜ì„¸ìš”.</p>
          <div class="data-actions">
            <button class="admin-btn admin-btn-primary" onclick="exportData()">ğŸ“¥ JSON ë‚´ë³´ë‚´ê¸°</button>
            <button class="admin-btn admin-btn-success" onclick="document.getElementById('importFile').click()">ğŸ“¤ JSON ê°€ì ¸ì˜¤ê¸°</button>
            <input type="file" id="importFile" accept=".json" style="display:none" onchange="importData(event)">
            <button class="admin-btn admin-btn-danger" onclick="resetAllData()">ğŸ—‘ï¸ ì „ì²´ ì´ˆê¸°í™”</button>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<div class="footer">Â© 2025-2026 í”„ë¦°ìŠ¤ Â· <a href="https://github.com" target="_blank">GitHub</a>ì—ì„œ í˜¸ìŠ¤íŒ…</div>

<!-- MODALS -->
<div class="modal-overlay" id="applyModal">
  <div class="modal">
    <div class="modal-header"><h2>âœï¸ ì—°ì°¨ ì‹ ì²­</h2><button class="modal-close" onclick="closeModal('applyModal')">âœ•</button></div>
    <div class="modal-body">
      <div class="form-group"><label class="form-label"><span class="form-step-num">1</span>ì‹ ì²­ì ì„ íƒ</label><div class="option-group" id="applicantOptions"></div></div>
      <div class="remaining-notice" id="remainingNotice" style="display:none">ğŸ’¡ ì”ì—¬ ì—°ì°¨: <strong id="remainingCount">0</strong>ì¼</div>
      <div class="form-group"><label class="form-label"><span class="form-step-num">2</span>íœ´ê°€ ì¢…ë¥˜</label>
        <div class="option-group" id="leaveTypeOptions">
          <div class="option-btn" data-value="ì—°ì°¨" onclick="selectLeaveType(this)">ğŸ—“ï¸ ì—°ì°¨<br><small style="font-size:9px;opacity:.7">1ì¼</small></div>
          <div class="option-btn" data-value="ë°˜ì°¨" onclick="selectLeaveType(this)">ğŸŒ— ë°˜ì°¨<br><small style="font-size:9px;opacity:.7">0.5ì¼</small></div>
          <div class="option-btn" data-value="ë°˜ë°˜ì°¨" onclick="selectLeaveType(this)">â±ï¸ ë°˜ë°˜ì°¨<br><small style="font-size:9px;opacity:.7">0.25ì¼</small></div>
        </div>
        <div class="sub-option-group" id="halfDayOptions">
          <div class="sub-option-btn" data-value="ì˜¤ì „" onclick="selectSubOption(this,'halfDayOptions')">â˜€ï¸ ì˜¤ì „ (9:30~14:00)</div>
          <div class="sub-option-btn" data-value="ì˜¤í›„" onclick="selectSubOption(this,'halfDayOptions')">ğŸŒ™ ì˜¤í›„ (14:00~18:30)</div>
        </div>
        <div class="sub-option-group" id="quarterOptions"></div>
      </div>
      <div class="form-group"><label class="form-label"><span class="form-step-num">3</span>ì‚¬ìš©ì¼ ì„ íƒ <small style="color:var(--text-light);font-weight:400">(ì—¬ëŸ¬ ë‚ ì§œ ê°€ëŠ¥)</small></label>
        <div class="date-picker-area">
          <div class="dp-header"><button onclick="changeDpMonth(-1)">â—€</button><span class="dp-title" id="dpTitle"></span><button onclick="changeDpMonth(1)">â–¶</button></div>
          <div class="dp-grid" id="dpGrid"></div>
        </div>
        <div class="selected-dates" id="selectedDates"></div>
        <div class="conflict-warning" id="conflictWarning">âš ï¸ í•´ë‹¹ ë‚ ì§œì— ë‹¤ë¥¸ íŒ€ì›ì´ ì´ë¯¸ íœ´ê°€ ì¤‘ì…ë‹ˆë‹¤!</div>
        <div class="team-schedule-preview" id="teamSchedulePreview"><h5>ğŸ“‹ í•´ë‹¹ì¼ íŒ€ì› íœ´ê°€</h5><div id="teamScheduleList"></div></div>
      </div>
      <div class="form-group"><label class="form-label"><span class="form-step-num">4</span>ì‹ ì²­ ì™„ë£Œ</label><button class="btn-submit" id="btnSubmit" onclick="submitApply()" disabled>ğŸ“‹ ìŠ¹ì¸ ë©”ì‹œì§€ ë³µì‚¬ & ì‹ ì²­ ì™„ë£Œ</button></div>
    </div>
  </div>
</div>

<div class="modal-overlay" id="detailModal">
  <div class="modal" style="width:560px"><div class="modal-header"><h2>ğŸ“„ ê°œì¸ ì—°ì°¨ ìƒì„¸</h2><button class="modal-close" onclick="closeModal('detailModal')">âœ•</button></div><div class="modal-body" id="detailContent"></div></div>
</div>

<div class="modal-overlay" id="addEmpModal">
  <div class="modal" style="width:460px">
    <div class="modal-header"><h2>â• ì‹ ê·œ ì§ì› ì¶”ê°€</h2><button class="modal-close" onclick="closeModal('addEmpModal')">âœ•</button></div>
    <div class="modal-body">
      <div class="form-row"><div class="form-group"><label class="form-label">ì´ë¦„</label><input type="text" class="form-input" id="newEmpName" placeholder="í™ê¸¸ë™"></div><div class="form-group"><label class="form-label">ì§ê¸‰</label><select class="form-select" id="newEmpTitle"><option>ì‚¬ì›</option><option>ëŒ€ë¦¬</option><option>ê³¼ì¥</option><option>ì°¨ì¥</option><option>ë¶€ì¥</option><option>ì‹¤ì¥</option></select></div></div>
      <div class="form-row"><div class="form-group"><label class="form-label">ì‚¬ì›ë²ˆí˜¸</label><input type="number" class="form-input" id="newEmpNo" placeholder="30"></div><div class="form-group"><label class="form-label">ì´ ì—°ì°¨ì¼ìˆ˜</label><input type="number" class="form-input" id="newEmpLeave" placeholder="15" step="0.5"></div></div>
      <div class="form-row"><div class="form-group"><label class="form-label">ê°±ì‹ ë…„ì›”</label><input type="month" class="form-input" id="newEmpRenew" value="2026-01"></div><div class="form-group"><label class="form-label">ëŒ€í‘œìƒ‰ìƒ</label><input type="color" class="form-input" id="newEmpColor" value="#6366F1" style="height:42px;padding:3px"></div></div>
      <button class="btn-submit green" onclick="addNewEmployee()">âœ… ì§ì› ì¶”ê°€</button>
    </div>
  </div>
</div>

<div class="modal-overlay" id="editEmpModal">
  <div class="modal" style="width:460px"><div class="modal-header"><h2>âœï¸ ì§ì› ì •ë³´ ìˆ˜ì •</h2><button class="modal-close" onclick="closeModal('editEmpModal')">âœ•</button></div><div class="modal-body" id="editEmpContent"></div></div>
</div>

<div class="copy-toast" id="copyToast"></div>
<div class="save-indicator" id="saveIndicator">ğŸ’¾ ìë™ ì €ì¥ë¨</div>

<script>
const ADMIN_PW='admin1234',STORAGE_KEY='prince_leave_v3';

const DEFAULT_EMP=[
  {id:'e1',name:'ë„ìŠ¹ì§€',title:'ì‹¤ì¥',empNo:2,totalLeave:15,remaining:11.25,renewDate:'2026-01',color:'#6366F1',history:[{date:'2026-01-08',type:'ì—°ì°¨',detail:''},{date:'2026-01-16',type:'ë°˜ë°˜ì°¨',detail:''}]},
  {id:'e2',name:'ì •í›ˆí•„',title:'ëŒ€ë¦¬',empNo:18,totalLeave:13,remaining:8.75,renewDate:'2025-12',color:'#EC4899',history:[{date:'2025-12-12',type:'ì—°ì°¨',detail:''},{date:'2025-12-23',type:'ë°˜ë°˜ì°¨',detail:''},{date:'2025-12-24',type:'ë°˜ë°˜ì°¨',detail:''},{date:'2026-01-29',type:'ë°˜ì°¨',detail:''},{date:'2026-02-04',type:'ë°˜ë°˜ì°¨',detail:''},{date:'2026-02-19',type:'ì—°ì°¨',detail:''},{date:'2026-02-20',type:'ì—°ì°¨',detail:''}]},
  {id:'e3',name:'ê¹€ì˜í›ˆ',title:'ëŒ€ë¦¬',empNo:20,totalLeave:13,remaining:9.25,renewDate:'2025-12',color:'#F59E0B',history:[{date:'2025-12-11',type:'ì—°ì°¨',detail:''},{date:'2026-01-02',type:'ë°˜ë°˜ì°¨',detail:''},{date:'2026-01-12',type:'ì—°ì°¨',detail:''},{date:'2026-01-14',type:'ë°˜ì°¨',detail:''},{date:'2026-01-28',type:'ë°˜ì°¨',detail:''},{date:'2026-02-02',type:'ë°˜ì°¨',detail:''}]},
  {id:'e4',name:'ìœ ì‹œì€',title:'ì‚¬ì›',empNo:24,totalLeave:12,remaining:7.75,renewDate:'2025-12',color:'#10B981',history:[{date:'2025-12-11',type:'ì—°ì°¨',detail:''},{date:'2025-12-12',type:'ì—°ì°¨',detail:''},{date:'2026-01-02',type:'ì—°ì°¨',detail:''},{date:'2026-01-22',type:'ë°˜ì°¨',detail:''},{date:'2026-01-29',type:'ë°˜ë°˜ì°¨',detail:''},{date:'2026-01-30',type:'ë°˜ì°¨',detail:''}]},
  {id:'e5',name:'ì§€ì˜ì€',title:'ì‚¬ì›',empNo:29,totalLeave:6,remaining:2,renewDate:'2026-04',color:'#8B5CF6',history:[{date:'2025-08-22',type:'ì—°ì°¨',detail:''},{date:'2025-11-28',type:'ì—°ì°¨',detail:''},{date:'2025-12-01',type:'ì—°ì°¨',detail:''},{date:'2026-01-07',type:'ì—°ì°¨',detail:''}]}
];

const HOLIDAYS={'2025-12-25':'í¬ë¦¬ìŠ¤ë§ˆìŠ¤','2026-01-01':'ì‹ ì •','2026-01-28':'ì„¤ë‚ ì „ë‚ ','2026-01-29':'ì„¤ë‚ ','2026-01-30':'ì„¤ë‚ ë‹¤ìŒë‚ ','2026-03-01':'ì‚¼ì¼ì ˆ','2026-05-05':'ì–´ë¦°ì´ë‚ ','2026-05-24':'ë¶€ì²˜ë‹˜ì˜¤ì‹ ë‚ ','2026-06-06':'í˜„ì¶©ì¼','2026-08-15':'ê´‘ë³µì ˆ','2026-09-24':'ì¶”ì„ì „ë‚ ','2026-09-25':'ì¶”ì„','2026-09-26':'ì¶”ì„ë‹¤ìŒë‚ ','2026-10-03':'ê°œì²œì ˆ','2026-10-09':'í•œê¸€ë‚ ','2026-12-25':'í¬ë¦¬ìŠ¤ë§ˆìŠ¤'};

let employees=[],isAdmin=false,calYear,calMonth,dpYear,dpMonth;
let selApp=null,selType=null,selSub=null,selDates=[];

// STORAGE
function save(){localStorage.setItem(STORAGE_KEY,JSON.stringify(employees));const el=document.getElementById('saveIndicator');el.classList.add('show');setTimeout(()=>el.classList.remove('show'),1400);}
function load(){try{const d=JSON.parse(localStorage.getItem(STORAGE_KEY));if(d&&Array.isArray(d)){employees=d;return true;}}catch(e){}return false;}
function exportData(){const b=new Blob([JSON.stringify(employees,null,2)],{type:'application/json'}),u=URL.createObjectURL(b),a=document.createElement('a');a.href=u;a.download=`í”„ë¦°ìŠ¤_ì—°ì°¨_${new Date().toISOString().slice(0,10)}.json`;a.click();URL.revokeObjectURL(u);toast('ğŸ“¥ ë°ì´í„°ê°€ ë‹¤ìš´ë¡œë“œë˜ì—ˆìŠµë‹ˆë‹¤');}
function importData(ev){const f=ev.target.files[0];if(!f)return;const r=new FileReader();r.onload=function(e){try{const d=JSON.parse(e.target.result);if(Array.isArray(d)){employees=d;save();refreshAll();toast('ğŸ“¤ ë°ì´í„°ë¥¼ ê°€ì ¸ì™”ìŠµë‹ˆë‹¤');}}catch(er){alert('íŒŒì¼ ì˜¤ë¥˜');}};r.readAsText(f);ev.target.value='';}
function resetAllData(){if(!confirm('âš ï¸ ëª¨ë“  ë°ì´í„°ë¥¼ ì´ˆê¸°í™”í•˜ì‹œê² ìŠµë‹ˆê¹Œ?'))return;if(!confirm('ğŸš¨ ìµœì¢… í™•ì¸: ë˜ëŒë¦´ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.'))return;employees=JSON.parse(JSON.stringify(DEFAULT_EMP));save();refreshAll();toast('ğŸ—‘ï¸ ì´ˆê¸°í™” ì™„ë£Œ');}

// INIT
window.addEventListener('DOMContentLoaded',()=>{
  if(!load()){employees=JSON.parse(JSON.stringify(DEFAULT_EMP));save();}
  employees.forEach((e,i)=>{if(!e.id)e.id='e_'+i+'_'+Date.now();});
  const n=new Date();calYear=n.getFullYear();calMonth=n.getMonth()+1;dpYear=calYear;dpMonth=calMonth;
  document.getElementById('todayBadge').textContent=`ğŸ“… ${n.getFullYear()}ë…„ ${n.getMonth()+1}ì›” ${n.getDate()}ì¼ (${['ì¼','ì›”','í™”','ìˆ˜','ëª©','ê¸ˆ','í† '][n.getDay()]})`;
  refreshAll();buildQuarterOpts();
});

function refreshAll(){buildStats();buildEmpTable();buildCalendar();buildAppOpts();buildAdminList();buildAdminSel();}
function R(n){return Math.round(n*100)/100;}

// TAB
function switchTab(id,btn){document.querySelectorAll('.tab-content').forEach(t=>t.classList.remove('active'));document.querySelectorAll('.nav-tab').forEach(t=>t.classList.remove('active'));document.getElementById('tab-'+id).classList.add('active');if(btn)btn.classList.add('active');if(id==='calendar')buildCalendar();}

// ADMIN AUTH
function toggleAdmin(){if(isAdmin){logoutAdmin();return;}document.getElementById('tabAdmin').classList.add('show');switchTab('admin',document.getElementById('tabAdmin'));}
function loginAdmin(){if(document.getElementById('adminPwInput').value===ADMIN_PW){isAdmin=true;document.getElementById('adminLocked').style.display='none';document.getElementById('adminPanel').style.display='block';document.getElementById('adminBadge').classList.add('active');document.getElementById('adminBadge').innerHTML='ğŸ”“ ê´€ë¦¬ì (ë¡œê·¸ì•„ì›ƒ)';document.getElementById('tabAdmin').classList.add('show');document.getElementById('adminPwError').style.display='none';document.getElementById('adminPwInput').value='';refreshAll();}else{document.getElementById('adminPwError').style.display='block';}}
function logoutAdmin(){isAdmin=false;document.getElementById('adminLocked').style.display='block';document.getElementById('adminPanel').style.display='none';document.getElementById('adminBadge').classList.remove('active');document.getElementById('adminBadge').innerHTML='ğŸ”’ ê´€ë¦¬ì';document.getElementById('tabAdmin').classList.remove('show');switchTab('dashboard',document.querySelectorAll('.nav-tab')[0]);refreshAll();}

// STATS
function buildStats(){
  const tE=employees.length,tU=employees.reduce((s,e)=>s+R(e.totalLeave-e.remaining),0),tL=employees.reduce((s,e)=>s+e.totalLeave,0);
  const avg=tL>0?((tU/tL)*100).toFixed(1):'0.0';
  const n=new Date(),mk=`${n.getFullYear()}-${String(n.getMonth()+1).padStart(2,'0')}`;
  let mc=0;employees.forEach(e=>e.history.forEach(h=>{if(h.date.startsWith(mk))mc++;}));
  document.getElementById('statsGrid').innerHTML=`
    <div class="stat-card"><div class="label">ì „ì²´ ì§ì›</div><div class="value">${tE}ëª…</div><div class="sub">ì—°ì°¨ ê´€ë¦¬ ëŒ€ìƒ</div></div>
    <div class="stat-card"><div class="label">ì „ì²´ ì‚¬ìš©ë¥ </div><div class="value">${avg}%</div><div class="sub">ì´ ${tL}ì¼ ì¤‘ ${tU}ì¼</div></div>
    <div class="stat-card"><div class="label">ì´ë²ˆë‹¬ íœ´ê°€</div><div class="value">${mc}ê±´</div><div class="sub">${n.getMonth()+1}ì›” ì‚¬ìš© ê±´ìˆ˜</div></div>
    <div class="stat-card"><div class="label">ì „ì²´ ì”ì—¬</div><div class="value">${employees.reduce((s,e)=>s+e.remaining,0)}ì¼</div><div class="sub">ë¯¸ì‚¬ìš© í•©ê³„</div></div>`;
}

// TABLE
function buildEmpTable(){
  const tb=document.getElementById('empTableBody');tb.innerHTML='';
  employees.forEach((e,i)=>{
    const u=R(e.totalLeave-e.remaining),rt=e.totalLeave>0?((u/e.totalLeave)*100).toFixed(0):0;
    let gc='#10B981',bc='badge-green',bt='ì—¬ìœ ';
    if(rt>=80){gc='#EF4444';bc='badge-red';bt='ì£¼ì˜';}else if(rt>=60){gc='#F59E0B';bc='badge-yellow';bt='ë³´í†µ';}
    tb.innerHTML+=`<tr onclick="openDetail(${i})"><td><div class="emp-name"><div class="emp-avatar" style="background:${e.color}">${e.name[0]}</div>${e.name} ${e.title}</div></td><td>${e.empNo}</td><td><b>${e.totalLeave}ì¼</b></td><td>${u}ì¼</td><td><b style="color:${gc}">${e.remaining}ì¼</b></td><td><div class="gauge-wrap"><div class="gauge-bar"><div class="gauge-fill" style="width:${rt}%;background:${gc}"></div></div><span class="gauge-text">${rt}%</span></div></td><td style="font-size:10px;color:var(--text-light)">${e.renewDate.replace('-','ë…„ ')}ì›”</td><td><span class="badge ${bc}">${bt}</span></td></tr>`;
  });
}

// CALENDAR
function buildCalendar(){
  document.getElementById('calMonthTitle').textContent=`${calYear}ë…„ ${calMonth}ì›”`;
  const g=document.getElementById('calendarGrid');g.innerHTML='';
  ['ì¼','ì›”','í™”','ìˆ˜','ëª©','ê¸ˆ','í† '].forEach(h=>{g.innerHTML+=`<div class="cal-day-header">${h}</div>`;});
  const fd=new Date(calYear,calMonth-1,1).getDay(),dim=new Date(calYear,calMonth,0).getDate(),pd=new Date(calYear,calMonth-1,0).getDate();
  const n=new Date(),ts=`${n.getFullYear()}-${String(n.getMonth()+1).padStart(2,'0')}-${String(n.getDate()).padStart(2,'0')}`;
  for(let i=fd-1;i>=0;i--)g.innerHTML+=`<div class="cal-day other-month"><div class="cal-date">${pd-i}</div></div>`;
  for(let d=1;d<=dim;d++){
    const ds=`${calYear}-${String(calMonth).padStart(2,'0')}-${String(d).padStart(2,'0')}`,dw=new Date(calYear,calMonth-1,d).getDay();
    let c='cal-day';if(ds===ts)c+=' today';if(dw===0)c+=' sunday';if(dw===6)c+=' saturday';if(HOLIDAYS[ds])c+=' holiday';
    let ev='';if(HOLIDAYS[ds])ev+=`<div class="cal-event holiday-ev">${HOLIDAYS[ds]}</div>`;
    employees.forEach(e=>e.history.forEach(h=>{if(h.date===ds){let cl=h.type==='ì—°ì°¨'?'annual':(h.type==='ë°˜ì°¨'?'half':'quarter');ev+=`<div class="cal-event ${cl}" title="${e.name} ${e.title} - ${h.type}${h.detail?' ('+h.detail+')':''}">${e.name[0]}${e.name[1]} ${h.type}</div>`;}}));
    g.innerHTML+=`<div class="${c}"><div class="cal-date">${d}</div>${ev}</div>`;
  }
  const tc=fd+dim,rem=tc%7===0?0:7-(tc%7);for(let i=1;i<=rem;i++)g.innerHTML+=`<div class="cal-day other-month"><div class="cal-date">${i}</div></div>`;
}
function changeCalMonth(d){calMonth+=d;if(calMonth>12){calMonth=1;calYear++;}if(calMonth<1){calMonth=12;calYear--;}buildCalendar();}

// DETAIL
function openDetail(idx){
  const e=employees[idx],u=R(e.totalLeave-e.remaining),rt=e.totalLeave>0?((u/e.totalLeave)*100).toFixed(1):'0.0';
  let gc='#10B981';if(rt>=80)gc='#EF4444';else if(rt>=60)gc='#F59E0B';
  const sorted=[...e.history].sort((a,b)=>b.date.localeCompare(a.date));
  let ac=0,hc=0,qc=0;e.history.forEach(h=>{if(h.type==='ì—°ì°¨')ac++;else if(h.type==='ë°˜ì°¨')hc++;else qc++;});
  let hH='';sorted.forEach((h,hi)=>{
    let cl=h.type==='ì—°ì°¨'?'annual':(h.type==='ë°˜ì°¨'?'half':'quarter');
    const dw=['ì¼','ì›”','í™”','ìˆ˜','ëª©','ê¸ˆ','í† '][new Date(h.date).getDay()];
    const origIdx=e.history.indexOf(h);
    const del=isAdmin?`<button class="history-del show" onclick="delHistory(${idx},${origIdx});event.stopPropagation()">ì‚­ì œ</button>`:'';
    hH+=`<div class="history-item"><div class="history-dot ${cl}"></div><div class="history-date">${h.date} (${dw})</div><span class="history-type ${cl}">${h.type}</span>${h.detail?`<span style="font-size:9px;color:var(--text-light);margin-left:3px">${h.detail}</span>`:''}${del}</div>`;
  });
  document.getElementById('detailContent').innerHTML=`
    <div class="detail-header"><div class="detail-avatar" style="background:${e.color}">${e.name[0]}</div><div class="detail-info"><h3>${e.name} ${e.title}</h3><p>ì‚¬ë²ˆ: ${e.empNo} Â· ê°±ì‹ : ${e.renewDate.replace('-','ë…„ ')}ì›”</p></div></div>
    <div class="detail-stats"><div class="detail-stat"><div class="val">${e.totalLeave}ì¼</div><div class="lbl">ì´ ì—°ì°¨</div></div><div class="detail-stat"><div class="val">${u}ì¼</div><div class="lbl">ì‚¬ìš©</div></div><div class="detail-stat"><div class="val" style="color:${gc}">${e.remaining}ì¼</div><div class="lbl">ì”ì—¬</div></div><div class="detail-stat"><div class="val" style="font-size:13px">${ac}ì—° ${hc}ë°˜ ${qc}ë°˜ë°˜</div><div class="lbl">ìœ í˜•ë³„</div></div></div>
    <div class="detail-gauge"><div class="detail-gauge-title">ì—°ì°¨ ì‚¬ìš©ë¥ </div><div class="detail-gauge-bar"><div class="detail-gauge-fill" style="width:0%;background:linear-gradient(90deg,${gc},${gc}CC)"></div></div><div class="detail-gauge-labels"><span>ì‚¬ìš© ${u}ì¼</span><span>${rt}%</span><span>ì”ì—¬ ${e.remaining}ì¼</span></div></div>
    <div class="section-title" style="font-size:13px;margin-bottom:8px"><div class="icon" style="width:24px;height:24px;font-size:11px">ğŸ“</div>ì‚¬ìš© ì´ë ¥ (${sorted.length}ê±´)</div>
    <div class="history-list">${hH||'<p style="color:var(--text-light);font-size:11px;text-align:center;padding:14px">ì´ë ¥ ì—†ìŒ</p>'}</div>`;
  document.getElementById('detailModal').classList.add('show');
  setTimeout(()=>{const f=document.querySelector('#detailContent .detail-gauge-fill');if(f)f.style.width=rt+'%';},50);
}
function delHistory(ei,hi){if(!isAdmin)return;const e=employees[ei],h=e.history[hi];if(!confirm(`"${h.date} ${h.type}" ì‚­ì œ?\nì”ì—¬ ì—°ì°¨ ìë™ ë³µêµ¬ë©ë‹ˆë‹¤.`))return;const v=h.type==='ì—°ì°¨'?1:(h.type==='ë°˜ì°¨'?.5:.25);e.remaining=R(e.remaining+v);e.history.splice(hi,1);save();refreshAll();openDetail(ei);toast('ğŸ—‘ï¸ ì´ë ¥ ì‚­ì œ Â· ì—°ì°¨ ë³µêµ¬');}

// ADMIN LIST
function buildAdminList(){
  const w=document.getElementById('adminEmpList');if(!w)return;w.innerHTML='';
  employees.forEach((e,i)=>{
    w.innerHTML+=`<div class="admin-emp-row"><div class="admin-emp-name"><div class="emp-avatar" style="background:${e.color};width:28px;height:28px;border-radius:7px;font-size:11px;display:flex;align-items:center;justify-content:center;color:#fff;font-weight:800">${e.name[0]}</div>${e.name} ${e.title}</div><div class="admin-emp-info"><span>ì‚¬ë²ˆ:${e.empNo}</span><span>ì´:${e.totalLeave}ì¼</span><span>ì”ì—¬:${e.remaining}ì¼</span><span>ê°±ì‹ :${e.renewDate}</span></div><div class="admin-emp-actions"><button class="admin-btn admin-btn-primary" onclick="openEditModal(${i})">âœï¸ ìˆ˜ì •</button><button class="admin-btn admin-btn-danger" onclick="delEmp(${i})">ğŸ—‘ï¸</button></div></div>`;
  });
}
function buildAdminSel(){const s=document.getElementById('adminTargetEmp');if(!s)return;s.innerHTML='<option value="">-- ì„ íƒ --</option>';employees.forEach((e,i)=>{s.innerHTML+=`<option value="${i}">${e.name} ${e.title} (ì”ì—¬ ${e.remaining}ì¼)</option>`;});}
function executeAdminAction(){
  const idx=document.getElementById('adminTargetEmp').value;if(idx===''){alert('ì§ì›ì„ ì„ íƒí•˜ì„¸ìš”.');return;}
  const act=document.getElementById('adminAction').value,days=parseFloat(document.getElementById('adminDays').value),rm=document.getElementById('adminRenewMonth').value,e=employees[parseInt(idx)];
  switch(act){
    case'renew':if(isNaN(days)||days<=0){alert('ì¼ìˆ˜ë¥¼ ì…ë ¥í•˜ì„¸ìš”.');return;}e.totalLeave=days;e.remaining=days;e.history=[];if(rm)e.renewDate=rm;toast(`ğŸ”„ ${e.name}ë‹˜ ${days}ì¼ ê°±ì‹ `);break;
    case'grant':if(isNaN(days)||days<=0){alert('ì¼ìˆ˜ë¥¼ ì…ë ¥í•˜ì„¸ìš”.');return;}e.totalLeave=R(e.totalLeave+days);e.remaining=R(e.remaining+days);toast(`â• ${e.name}ë‹˜ ${days}ì¼ ì¶”ê°€`);break;
    case'setTotal':if(isNaN(days)||days<0){alert('ì¼ìˆ˜ë¥¼ ì…ë ¥í•˜ì„¸ìš”.');return;}const df=days-e.totalLeave;e.totalLeave=days;e.remaining=R(Math.max(0,e.remaining+df));toast(`ğŸ“ ${e.name}ë‹˜ ì´ ì—°ì°¨ ${days}ì¼`);break;
    case'setRemain':if(isNaN(days)||days<0){alert('ì¼ìˆ˜ë¥¼ ì…ë ¥í•˜ì„¸ìš”.');return;}e.remaining=days;toast(`ğŸ“ ${e.name}ë‹˜ ì”ì—¬ ${days}ì¼`);break;
  }
  if(rm&&act!=='renew')e.renewDate=rm;save();refreshAll();
}
function delEmp(i){const e=employees[i];if(!confirm(`"${e.name} ${e.title}" ì‚­ì œ?`))return;employees.splice(i,1);save();refreshAll();toast(`ğŸ—‘ï¸ ${e.name}ë‹˜ ì‚­ì œ`);}

// ADD EMP
function openAddEmpModal(){document.getElementById('newEmpName').value='';document.getElementById('newEmpNo').value='';document.getElementById('newEmpLeave').value='15';document.getElementById('newEmpRenew').value=new Date().toISOString().slice(0,7);const c=['#6366F1','#EC4899','#F59E0B','#10B981','#8B5CF6','#EF4444','#06B6D4','#84CC16'];document.getElementById('newEmpColor').value=c[employees.length%c.length];document.getElementById('addEmpModal').classList.add('show');}
function addNewEmployee(){
  const nm=document.getElementById('newEmpName').value.trim(),tt=document.getElementById('newEmpTitle').value,no=parseInt(document.getElementById('newEmpNo').value),tl=parseFloat(document.getElementById('newEmpLeave').value),rd=document.getElementById('newEmpRenew').value,cl=document.getElementById('newEmpColor').value;
  if(!nm){alert('ì´ë¦„ì„ ì…ë ¥í•˜ì„¸ìš”.');return;}if(isNaN(no)){alert('ì‚¬ì›ë²ˆí˜¸ë¥¼ ì…ë ¥í•˜ì„¸ìš”.');return;}if(employees.some(e=>e.empNo===no)){alert('ì¤‘ë³µëœ ì‚¬ì›ë²ˆí˜¸ì…ë‹ˆë‹¤.');return;}if(isNaN(tl)||tl<=0){alert('ì—°ì°¨ì¼ìˆ˜ë¥¼ ì…ë ¥í•˜ì„¸ìš”.');return;}
  employees.push({id:'e_'+Date.now(),name:nm,title:tt,empNo:no,totalLeave:tl,remaining:tl,renewDate:rd||new Date().toISOString().slice(0,7),color:cl,history:[]});
  save();refreshAll();closeModal('addEmpModal');toast(`âœ… ${nm} ${tt} ì¶”ê°€ ì™„ë£Œ`);
}

// EDIT EMP
function openEditModal(i){
  const e=employees[i];
  document.getElementById('editEmpContent').innerHTML=`
    <div class="form-row"><div class="form-group"><label class="form-label">ì´ë¦„</label><input type="text" class="form-input" id="edN" value="${e.name}"></div><div class="form-group"><label class="form-label">ì§ê¸‰</label><select class="form-select" id="edT">${['ì‚¬ì›','ëŒ€ë¦¬','ê³¼ì¥','ì°¨ì¥','ë¶€ì¥','ì‹¤ì¥'].map(t=>`<option ${t===e.title?'selected':''}>${t}</option>`).join('')}</select></div></div>
    <div class="form-row"><div class="form-group"><label class="form-label">ì‚¬ì›ë²ˆí˜¸</label><input type="number" class="form-input" id="edNo" value="${e.empNo}"></div><div class="form-group"><label class="form-label">ì´ ì—°ì°¨</label><input type="number" class="form-input" id="edTL" value="${e.totalLeave}" step="0.5"></div></div>
    <div class="form-row"><div class="form-group"><label class="form-label">ì”ì—¬ì¼</label><input type="number" class="form-input" id="edR" value="${e.remaining}" step="0.25"></div><div class="form-group"><label class="form-label">ê°±ì‹ ë…„ì›”</label><input type="month" class="form-input" id="edRD" value="${e.renewDate}"></div></div>
    <div class="form-group"><label class="form-label">ìƒ‰ìƒ</label><input type="color" class="form-input" id="edC" value="${e.color}" style="height:42px;padding:3px"></div>
    <button class="btn-submit" onclick="saveEdit(${i})">ğŸ’¾ ì €ì¥</button>`;
  document.getElementById('editEmpModal').classList.add('show');
}
function saveEdit(i){
  const e=employees[i];e.name=document.getElementById('edN').value.trim()||e.name;e.title=document.getElementById('edT').value;e.empNo=parseInt(document.getElementById('edNo').value)||e.empNo;e.totalLeave=parseFloat(document.getElementById('edTL').value)||e.totalLeave;e.remaining=parseFloat(document.getElementById('edR').value);if(isNaN(e.remaining))e.remaining=0;e.renewDate=document.getElementById('edRD').value||e.renewDate;e.color=document.getElementById('edC').value;
  save();refreshAll();closeModal('editEmpModal');toast(`ğŸ’¾ ${e.name}ë‹˜ ì •ë³´ ì €ì¥`);
}

// APPLY
function buildAppOpts(){const w=document.getElementById('applicantOptions');if(!w)return;w.innerHTML='';employees.forEach((e,i)=>{w.innerHTML+=`<div class="option-btn" data-idx="${i}" onclick="selApplicant(this)">${e.name} ${e.title}</div>`;});}
function buildQuarterOpts(){const w=document.getElementById('quarterOptions');w.innerHTML='';['09:30~11:30','10:00~12:00','10:30~12:30','11:00~13:00','11:30~13:30','12:00~14:00','13:00~15:00','13:30~15:30','14:00~16:00','14:30~16:30','15:00~17:00','15:30~17:30','16:00~18:00'].forEach(s=>{w.innerHTML+=`<div class="sub-option-btn" data-value="${s}" onclick="selectSubOption(this,'quarterOptions')">${s}</div>`;});}
function selApplicant(el){document.querySelectorAll('#applicantOptions .option-btn').forEach(b=>b.classList.remove('selected'));el.classList.add('selected');selApp=employees[parseInt(el.dataset.idx)];document.getElementById('remainingNotice').style.display='flex';document.getElementById('remainingCount').textContent=selApp.remaining;validateForm();}
function selectLeaveType(el){document.querySelectorAll('#leaveTypeOptions .option-btn').forEach(b=>b.classList.remove('selected'));el.classList.add('selected');selType=el.dataset.value;document.getElementById('halfDayOptions').classList.remove('show');document.getElementById('quarterOptions').classList.remove('show');selSub=null;document.querySelectorAll('.sub-option-btn').forEach(b=>b.classList.remove('selected'));if(selType==='ë°˜ì°¨')document.getElementById('halfDayOptions').classList.add('show');else if(selType==='ë°˜ë°˜ì°¨')document.getElementById('quarterOptions').classList.add('show');validateForm();}
function selectSubOption(el,gid){document.querySelectorAll(`#${gid} .sub-option-btn`).forEach(b=>b.classList.remove('selected'));el.classList.add('selected');selSub=el.dataset.value;validateForm();}

// DATE PICKER
function buildDP(){
  document.getElementById('dpTitle').textContent=`${dpYear}ë…„ ${dpMonth}ì›”`;const g=document.getElementById('dpGrid');g.innerHTML='';
  ['ì¼','ì›”','í™”','ìˆ˜','ëª©','ê¸ˆ','í† '].forEach(h=>{g.innerHTML+=`<div class="dp-day-header">${h}</div>`;});
  const fd=new Date(dpYear,dpMonth-1,1).getDay(),dim=new Date(dpYear,dpMonth,0).getDate(),n=new Date(),ts=`${n.getFullYear()}-${String(n.getMonth()+1).padStart(2,'0')}-${String(n.getDate()).padStart(2,'0')}`;
  for(let i=0;i<fd;i++)g.innerHTML+=`<div class="dp-day dp-empty"></div>`;
  for(let d=1;d<=dim;d++){const ds=`${dpYear}-${String(dpMonth).padStart(2,'0')}-${String(d).padStart(2,'0')}`,dw=new Date(dpYear,dpMonth-1,d).getDay();let c='dp-day';if(ds===ts)c+=' dp-today';if(dw===0)c+=' dp-sunday';if(dw===6)c+=' dp-saturday';if(HOLIDAYS[ds])c+=' dp-holiday';if(selDates.includes(ds))c+=' dp-selected';g.innerHTML+=`<div class="${c}" onclick="togDate('${ds}',this)">${d}</div>`;}
}
function changeDpMonth(d){dpMonth+=d;if(dpMonth>12){dpMonth=1;dpYear++;}if(dpMonth<1){dpMonth=12;dpYear--;}buildDP();}
function togDate(ds,el){if(el.classList.contains('dp-disabled')||el.classList.contains('dp-empty'))return;const i=selDates.indexOf(ds);if(i>-1){selDates.splice(i,1);el.classList.remove('dp-selected');}else{selDates.push(ds);el.classList.add('dp-selected');}selDates.sort();renderSelDates();checkConflict();validateForm();}
function renderSelDates(){const w=document.getElementById('selectedDates');w.innerHTML='';selDates.forEach(d=>{const dw=['ì¼','ì›”','í™”','ìˆ˜','ëª©','ê¸ˆ','í† '][new Date(d).getDay()];w.innerHTML+=`<div class="selected-date-tag">${d} (${dw})<span class="remove" onclick="rmDate('${d}')">âœ•</span></div>`;});}
function rmDate(ds){selDates=selDates.filter(d=>d!==ds);renderSelDates();buildDP();checkConflict();validateForm();}
function checkConflict(){const wn=document.getElementById('conflictWarning'),pv=document.getElementById('teamSchedulePreview'),ls=document.getElementById('teamScheduleList');wn.classList.remove('show');pv.classList.remove('show');ls.innerHTML='';if(!selApp||!selDates.length)return;let has=false,items=[];selDates.forEach(ds=>{employees.forEach(e=>{if(e.id===selApp.id)return;e.history.forEach(h=>{if(h.date===ds){has=true;items.push(`${ds}: ${e.name} ${e.title} - ${h.type}`);}});});});if(has){wn.classList.add('show');pv.classList.add('show');items.forEach(s=>{ls.innerHTML+=`<div class="sch-item">âš ï¸ ${s}</div>`;});}}
function validateForm(){const b=document.getElementById('btnSubmit');let v=true;if(!selApp)v=false;if(!selType)v=false;if(selType==='ë°˜ì°¨'&&!selSub)v=false;if(selType==='ë°˜ë°˜ì°¨'&&!selSub)v=false;if(!selDates.length)v=false;if(v&&selApp){const lv=selType==='ì—°ì°¨'?1:(selType==='ë°˜ì°¨'?.5:.25);if(lv*selDates.length>selApp.remaining)v=false;}b.disabled=!v;}
function submitApply(){
  if(!selApp||!selType||!selDates.length)return;
  const dates=selDates.join(', ');let tt=selType;if(selType==='ë°˜ì°¨')tt=`ë°˜ì°¨(${selSub})`;else if(selType==='ë°˜ë°˜ì°¨')tt=`ë°˜ë°˜ì°¨(${selSub})`;
  const msg=`ëŒ€í‘œë‹˜~ ${dates}ì— ${tt}ë¥¼ ì‚¬ìš©í•˜ë ¤ê³  í•©ë‹ˆë‹¤. ìŠ¹ì¸ ë¶€íƒë“œë¦½ë‹ˆë‹¤. (${selApp.name} ${selApp.title})`;
  const lv=selType==='ì—°ì°¨'?1:(selType==='ë°˜ì°¨'?.5:.25);
  selDates.forEach(d=>{selApp.history.push({date:d,type:selType,detail:selSub||''});});
  selApp.remaining=R(selApp.remaining-lv*selDates.length);
  navigator.clipboard.writeText(msg).then(()=>toast('âœ… ìŠ¹ì¸ ìš”ì²­ ë©”ì‹œì§€ê°€ ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤!')).catch(()=>{const t=document.createElement('textarea');t.value=msg;document.body.appendChild(t);t.select();document.execCommand('copy');document.body.removeChild(t);toast('âœ… ìŠ¹ì¸ ìš”ì²­ ë©”ì‹œì§€ê°€ ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤!');});
  save();refreshAll();resetApply();closeModal('applyModal');
}
function resetApply(){selApp=null;selType=null;selSub=null;selDates=[];document.querySelectorAll('#applyModal .option-btn,#applyModal .sub-option-btn').forEach(b=>b.classList.remove('selected'));document.getElementById('halfDayOptions').classList.remove('show');document.getElementById('quarterOptions').classList.remove('show');document.getElementById('selectedDates').innerHTML='';document.getElementById('remainingNotice').style.display='none';document.getElementById('conflictWarning').classList.remove('show');document.getElementById('teamSchedulePreview').classList.remove('show');document.getElementById('btnSubmit').disabled=true;}
function openApplyModal(){resetApply();dpYear=new Date().getFullYear();dpMonth=new Date().getMonth()+1;buildDP();document.getElementById('applyModal').classList.add('show');}

// MODAL
function closeModal(id){document.getElementById(id).classList.remove('show');}
document.querySelectorAll('.modal-overlay').forEach(o=>{o.addEventListener('click',e=>{if(e.target===o)o.classList.remove('show');});});

// TOAST
function toast(msg){const t=document.getElementById('copyToast');t.textContent=msg;t.classList.add('show');setTimeout(()=>t.classList.remove('show'),2400);}
</script>
</body>
</html>
